<!-- Enhanced Sidebar Navigation -->
<aside class="sidebar" 
       id="sidebar" 
       role="navigation" 
       aria-label="Main navigation">
    
    <!-- Logo Section -->
    <div class="sidebar-header">
        <div class="logo-section text-center mb-4">
            <h4 class="logo-title mb-2">
                <i class="fas fa-download text-primary"></i>
                Media Scraper
            </h4>
            <span class="badge bg-success version-badge">v2.0 Pro</span>
        </div>
    </div>
    
    <!-- Main Navigation -->
    <nav class="sidebar-nav" role="menubar">
        <ul class="nav-list" role="none">
            <li role="none">
                <button class="nav-item" 
                        type="button"
                        data-section="dashboard"
                        role="menuitem"
                        aria-label="Dashboard section">
                    <i class="fas fa-tachometer-alt" aria-hidden="true"></i>
                    <span>Dashboard</span>
                </button>
            </li>
            <li role="none">
                <button class="nav-item active" 
                        type="button"
                        data-section="search"
                        role="menuitem"
                        aria-label="Search and download section">
                    <i class="fas fa-search" aria-hidden="true"></i>
                    <span>Search & Download</span>
                </button>
            </li>
            <li role="none">
                <button class="nav-item" 
                        type="button"
                        data-section="assets"
                        role="menuitem"
                        aria-label="Assets library section">
                    <i class="fas fa-images" aria-hidden="true"></i>
                    <span>Assets Library</span>
                </button>
            </li>
            <li role="none">
                <button class="nav-item admin-only" 
                        type="button"
                        data-section="admin"
                        role="menuitem"
                        aria-label="Admin panel section"
                        style="display: none;">
                    <i class="fas fa-users-cog" aria-hidden="true"></i>
                    <span>Admin Panel</span>
                </button>
            </li>
            <li role="none">
                <button class="nav-item" 
                        type="button"
                        data-section="settings"
                        role="menuitem"
                        aria-label="Settings section">
                    <i class="fas fa-sliders-h" aria-hidden="true"></i>
                    <span>Settings</span>
                </button>
            </li>
        </ul>
    </nav>
    
    <!-- Enhanced System Status -->
    <section class="system-status mt-4 p-3 rounded" 
             aria-labelledby="system-status-heading">
        <h3 id="system-status-heading" class="h6">
            <i class="fas fa-server" aria-hidden="true"></i> 
            System Status
        </h3>
        
        <!-- Status Indicators -->
        <div class="status-grid">
            <div class="status-item">
                <div class="status-indicator online" id="api-status"></div>
                <span class="status-label">API</span>
            </div>
            <div class="status-item">
                <div class="status-indicator online" id="db-status"></div>
                <span class="status-label">Database</span>
            </div>
            <div class="status-item">
                <div class="status-indicator" id="search-status"></div>
                <span class="status-label">Search</span>
            </div>
        </div>
        
        <!-- Storage Info -->
        <div class="storage-info mt-3">
            <small class="text-muted">
                <i class="fas fa-hdd"></i> 
                Storage: <span id="storage-used">--</span> / <span id="storage-total">--</span>
            </small>
        </div>
        
        <!-- Version Info -->
        <div class="version-info mt-2">
            <small class="text-muted">
                <i class="fas fa-code-branch"></i> 
                Version: <span id="app-version">2.0.5</span>
            </small>
        </div>
    </section>
    
    
    <!-- User Profile (if logged in) -->
    <section class="user-profile mt-4" 
             id="user-profile-section"
             style="display: none;"
             aria-labelledby="user-profile-heading">
        <h3 id="user-profile-heading" class="h6">
            <i class="fas fa-user" aria-hidden="true"></i> 
            Profile
        </h3>
        
        <div class="profile-card p-3 bg-light rounded">
            <div class="d-flex align-items-center mb-2">
                <div class="avatar-placeholder">
                    <i class="fas fa-user"></i>
                </div>
                <div class="ms-2">
                    <div class="username" id="user-display-name">Guest</div>
                    <small class="text-muted" id="user-plan">Free Plan</small>
                </div>
            </div>
            
            <!-- Credits Display -->
            <div class="credits-info">
                <div class="d-flex justify-content-between">
                    <span class="text-muted">Credits:</span>
                    <span class="fw-bold text-warning" id="sidebar-credits">0</span>
                </div>
                <div class="progress progress-sm mt-1">
                    <div class="progress-bar bg-warning" 
                         role="progressbar" 
                         style="width: 0%;" 
                         id="credits-progress"></div>
                </div>
            </div>
            
            <div class="profile-actions mt-2">
                <!-- Subscription feature not yet implemented
                <a href="#" class="btn btn-outline-primary btn-sm">
                    <i class="fas fa-cog"></i> Account
                </a>
                -->
                <a href="{{ url_for('auth.logout') }}" class="btn btn-outline-secondary btn-sm">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </a>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer class="sidebar-footer mt-auto pt-3">
        <div class="text-center">
            <small class="text-muted">
                &copy; 2024 Enhanced Media Scraper<br>
                <span id="copyright-year">All rights reserved</span>
            </small>
        </div>
    </footer>
</aside>

<!-- Sidebar JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize sidebar
    initializeSidebar();
    
    function initializeSidebar() {
        // Handle navigation
        const navItems = document.querySelectorAll('.nav-item');
        navItems.forEach(item => {
            item.addEventListener('click', function() {
                const section = this.dataset.section;
                if (section) {
                    // Remove active class from all items
                    navItems.forEach(nav => nav.classList.remove('active'));
                    // Add active class to clicked item
                    this.classList.add('active');
                    
                    // Navigate to section
                    if (window.app && window.app.showSection) {
                        window.app.showSection(section);
                    }
                }
            });
        });
        
        // Update system status
        updateSystemStatus();
        
        // Update user profile if logged in
        updateUserProfile();
        
        // Check admin permissions
        checkAdminAccess();
        
        // Set copyright year
        document.getElementById('copyright-year').textContent = new Date().getFullYear();
    }
    
    function updateSystemStatus() {
        // Update status indicators
        const indicators = {
            'api-status': 'online',
            'db-status': 'online',
            'search-status': 'idle'
        };
        
        Object.entries(indicators).forEach(([id, status]) => {
            const element = document.getElementById(id);
            if (element) {
                element.className = `status-indicator ${status}`;
            }
        });
    }
    
    function updateUserProfile() {
        // This would be populated by the main app
        // Check if user is logged in and update profile section
        if (window.app && window.app.state && window.app.state.userInfo) {
            const profileSection = document.getElementById('user-profile-section');
            if (profileSection) {
                profileSection.style.display = 'block';
                
                // Update user info
                const nameElement = document.getElementById('user-display-name');
                const planElement = document.getElementById('user-plan');
                const creditsElement = document.getElementById('sidebar-credits');
                
                const user = window.app.state.userInfo || {};
                if (nameElement) nameElement.textContent = user.name || user.email || 'Guest';
                if (planElement) planElement.textContent = user.plan || 'Free Plan';
                if (creditsElement) creditsElement.textContent = (user.credits ?? 0).toString();
            }
        }
    }
    
    function checkAdminAccess() {
        // Check if user has admin permissions
        const adminNav = document.querySelector('.nav-item.admin-only');
        if (adminNav) {
            // This would be checked against user permissions
            // For now, hide it unless user is admin
            if (window.app && window.app.state && window.app.state.userInfo && window.app.state.userInfo.isAdmin) {
                adminNav.style.display = 'block';
            }
        }
    }
    
    // Export functions for global access
    window.sidebarFunctions = {
        updateSystemStatus,
        updateUserProfile,
        checkAdminAccess
    };
});
</script> 
